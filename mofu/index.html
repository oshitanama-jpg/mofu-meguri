<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>もふめぐり — 検索型一覧＋マップ（食べログ風・オリジナル）</title>
<link href="https://fonts.googleapis.com/css2?family=Kosugi+Maru&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f6f6f7;
    --card:#ffffff;
    --accent:#ff6fa3; /* 暖色アクセント（オリジナル） */
    --muted:#8a8a8f;
    --shadow: 0 6px 20px rgba(15,15,20,0.06);
  }
  body{margin:0;font-family:'Kosugi Maru',sans-serif;background:var(--bg);color:#222}
  header{background:#fff;padding:14px 20px;border-bottom:1px solid #eee;display:flex;align-items:center;gap:16px}
  .brand{font-weight:800;color:var(--accent);font-size:20px}
  .searchbar{flex:1;display:flex;gap:8px}
  .searchbar input{flex:1;padding:10px 12px;border-radius:6px;border:1px solid #e6e6e9;font-size:15px}
  .searchbar button{background:var(--accent);color:#fff;border:none;padding:10px 14px;border-radius:6px;cursor:pointer}

  .container{max-width:1200px;margin:18px auto;padding:0 16px;display:grid;grid-template-columns:1fr 420px;gap:16px}
  /* 左リスト */
  .left{display:flex;flex-direction:column;gap:12px}
  .filters{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px}
  .chip{background:#fff;border:1px solid #eee;padding:8px 10px;border-radius:999px;font-size:13px;color:var(--muted);cursor:pointer}
  .results-info{font-size:14px;color:var(--muted);margin-bottom:6px}

  .card{display:flex;gap:12px;background:var(--card);padding:12px;border-radius:10px;align-items:flex-start;box-shadow:var(--shadow);cursor:pointer;border:1px solid #fff;transition:transform .12s,box-shadow .12s}
  .card:hover{transform:translateY(-4px);box-shadow:0 12px 30px rgba(15,15,20,0.08)}
  .thumb{width:120px;height:84px;border-radius:8px;background:#f2f2f4;flex-shrink:0;object-fit:cover}
  .info{flex:1}
  .title-row{display:flex;align-items:center;gap:8px}
  .title{font-weight:700;font-size:16px}
  .badge{background:linear-gradient(90deg,#fff,#fff);border-radius:8px;padding:6px 8px;border:1px solid #eee;font-size:13px;color:var(--muted)}
  .meta{font-size:13px;color:var(--muted);margin-top:6px}
  .rating{margin-left:auto;background:#fff;padding:6px 10px;border-radius:8px;border:1px solid #ffe6f0;color:var(--accent);font-weight:700}

  /* 右マップ */
  .right{position:relative}
  #map{width:100%;height:680px;border-radius:12px;box-shadow:var(--shadow);overflow:hidden;border:1px solid #eee}

  /* モバイル */
  @media (max-width:980px){
    .container{grid-template-columns:1fr; }
    #map{height:420px}
  }
</style>
</head>
<body>

<header>
  <div class="brand">もふめぐり</div>
  <div class="searchbar">
    <input id="q" placeholder="例：川崎 猫カフェ / 駅名 / 店名 で検索" />
    <button id="searchBtn">検索</button>
  </div>
  <div style="width:80px;text-align:right;color:var(--muted)">ログイン</div>
</header>

<main class="container">
  <section class="left">
    <div class="filters">
      <div class="chip" data-filter="all">すべて</div>
      <div class="chip" data-filter="cat">猫カフェ</div>
      <div class="chip" data-filter="dog">犬カフェ</div>
      <div class="chip" data-filter="private">個室あり</div>
      <div class="chip" data-filter="reserve">予約可</div>
    </div>

    <div class="results-info" id="resultsInfo">川崎市内 — <span id="count">0</span> 件見つかりました</div>

    <div id="list"></div>
  </section>

  <aside class="right">
    <div id="map">地図読み込み中…</div>
  </aside>
</main>

<script>
/* --- ダミーデータ（ここをスプレッドシート読み込みに置き換える） --- */
const cafes = [
  { id:"k001", name:"にゃんくる 川崎店", lat:35.5301, lng:139.7036, category:"cat", price:"60分 1,200円", hours:"11:00-20:00", img:"https://placekitten.com/300/200", rating:4.5, features:["抱っこOK","予約不要"] },
  { id:"k002", name:"ねこカフェラボ", lat:35.5235, lng:139.6950, category:"cat", price:"30分 800円", hours:"10:00-19:00", img:"https://placekitten.com/301/200", rating:4.1, features:["フリータイム"] },
  { id:"k003", name:"わんわんカフェ川崎", lat:35.5252, lng:139.7100, category:"dog", price:"30分 900円", hours:"11:00-19:00", img:"https://placebear.com/300/200", rating:4.2, features:["小型犬中心"] }
];
/* -------------------------------------------------------------- */

let map, markers = [], infoWindow;
function initMap(){
  const center = { lat: 35.526, lng: 139.704 };
  map = new google.maps.Map(document.getElementById('map'), { center, zoom:13, mapTypeControl:false, streetViewControl:false });
  infoWindow = new google.maps.InfoWindow();

  // 初期リスト・マーカー表示
  renderList(cafes);
  placeMarkers(cafes);
}

function placeMarkers(list){
  // 既存削除
  markers.forEach(m => m.setMap(null));
  markers = [];
  list.forEach(item=>{
    const m = new google.maps.Marker({
      position: {lat:item.lat,lng:item.lng},
      map,
      title:item.name
    });
    m.addListener('click', ()=>{
      infoWindow.setContent(`<div style="min-width:180px"><strong>${item.name}</strong><div style="color:#666;font-size:13px">${item.price} ・ ${item.hours}</div></div>`);
      infoWindow.open(map,m);
    });
    markers.push(m);
  });
}

function renderList(list){
  const listDiv = document.getElementById('list');
  listDiv.innerHTML = '';
  document.getElementById('count').textContent = list.length;
  list.forEach(item=>{
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <img class="thumb" src="${item.img}" alt="${item.name}" style="width:120px;height:84px;border-radius:8px;object-fit:cover">
      <div class="info">
        <div class="title-row">
          <div class="title">${item.name}</div>
          <div class="rating">${item.rating} ★</div>
        </div>
        <div class="meta">${item.price} · ${item.hours}</div>
        <div style="margin-top:8px;color:var(--muted);font-size:13px">${item.features.join('・')}</div>
      </div>
    `;
    card.addEventListener('click', ()=>{
      map.panTo({lat:item.lat,lng:item.lng});
      map.setZoom(15);
      // マーカーを開く（該当するものを探して開く）
      const mk = markers.find(mk=>Math.abs(mk.getPosition().lat()-item.lat)<0.0001 && Math.abs(mk.getPosition().lng()-item.lng)<0.0001);
      if(mk){
        google.maps.event.trigger(mk,'click');
      }
    });
    listDiv.appendChild(card);
  });
}

/* 検索・フィルタ機能（簡易） */
document.getElementById('searchBtn').addEventListener('click', ()=> {
  const q = document.getElementById('q').value.trim().toLowerCase();
  let filtered = cafes.filter(c => c.name.toLowerCase().includes(q) || (c.features && c.features.join(' ').toLowerCase().includes(q)));
  renderList(filtered);
  placeMarkers(filtered);
});
document.querySelectorAll('.chip').forEach(ch=>{
  ch.addEventListener('click', ()=>{
    const f = ch.dataset.filter;
    if(f==='all'){ renderList(cafes); placeMarkers(cafes); return; }
    const filtered = cafes.filter(c=>c.category===f);
    renderList(filtered); placeMarkers(filtered);
  });
});
</script>

<!-- Google Maps APIキーを入れてください -->
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>
</body>
</html>
